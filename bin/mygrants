#!/bin/bash
mysql -B -N "$@" -e "SELECT DISTINCT CONCAT(\"SHOW GRANTS FOR '\", user, \"'@'\", host, \"';\") AS query FROM mysql.user WHERE host rlike '^[0-9.]*%$|localhost' ORDER BY user, host" | \
  mysql "$@" | \
  sed 's/\(GRANT .*\)/\1;/;s/^\(Grants for .*\)/## \1 ##/;/##/{x;p;x;}'
